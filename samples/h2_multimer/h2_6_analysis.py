import matplotlib.pyplot as plt

fmo_vqe_result = [
    ('0.500', -5.50562283, False),
    ('0.723', -6.28723939, False),
    ('0.750', -6.31867664, False),
    ('1.000', -6.60301516, False),
    ('1.250', -6.71874946, True),
    ('1.500', -6.77862497, True),
    ('1.750', -6.80665449, True),
    ('2.000', -6.81595755, True),
    ('2.250', -6.81958451, True),
    ('2.500', -6.82120678, True),
    ('2.750', -6.82145089, True),
    ('3.000', -6.82176061, True),
    ('3.250', -6.82209949, True),
    ('3.500', -6.82231447, True),
    ('3.750', -6.82279873, True),
    ('4.000', -6.82284761, True),
    ('4.250', -6.82298382, True),
    ('4.500', -6.82282253, True),
]

fmo_rhf_result = [
    ('0.500', -5.44157185, True),
    ('0.723', -6.17811746, True),
    ('0.750', -6.22490913, True),
    ('1.000', -6.49875199, True),
    ('1.250', -6.61489862, True),
    ('1.500', -6.66679763, True),
    ('1.750', -6.6897268, True),
    ('2.000', -6.69943432, True),
    ('2.250', -6.7032762, True),
    ('2.500', -6.70463639, True),
    ('2.750', -6.70500806, True),
    ('3.000', -6.70501892, True),
    ('3.250', -6.70492023, True),
    ('3.500', -6.70480507, True),
    ('3.750', -6.70470278, True),
    ('4.000', -6.70461913, True),
    ('4.250', -6.70455245, True),
    ('4.500', -6.70449949, True),
]

rhf_result = [
    ('0.500', -4.989959823935791),
    ('0.723', -5.975542520491608),
    ('0.750', -6.041353184093701),
    ('1.000', -6.427645691267571),
    ('1.250', -6.5856434375894874),
    ('1.500', -6.653228207321385),
    ('1.750', -6.682538090160895),
    ('2.000', -6.6951498442028505),
    ('2.250', -6.700475042800692),
    ('2.500', -6.702677082748821),
    ('2.750', -6.703571450787624),
    ('3.000', -6.7039308903790396),
    ('3.250', -6.704077249069623),
    ('3.500', -6.704140800416475),
    ('3.750', -6.704172174197806),
    ('4.000', -6.704190329732539),
    ('4.250', -6.704202314781973),
    ('4.500', -6.7042108867489345),
]

fci_result = [
    ('0.500', -5.156838717715004),
    ('0.723', -6.100940803397322),
    ('0.750', -6.164909038560673),
    ('1.000', -6.5446227472720615),
    ('1.250', -6.702994963054321),
    ('1.500', -6.7718137823222),
    ('1.750', -6.801824601919934),
    ('2.000', -6.81462591579192),
    ('2.250', -6.819897291050053),
    ('2.500', -6.821982241277176),
    ('2.750', -6.822770730760894),
    ('3.000', -6.823052255999846),
    ('3.250', -6.823145165968324),
    ('3.500', -6.823172701808636),
    ('3.750', -6.82317970757806),
    ('4.000', -6.82318115775862),
    ('4.250', -6.823181503556272),
    ('4.500', -6.823181832181917),
]
'''
ccsd_result = [
    -3.411525546751755,
    -4.548688923681719,
    -5.685852430900173,
    -6.823015674236659,
    -7.960179159092178,
    -9.097342481196153,
    -10.234505958700488
]
'''
if __name__ == '__main__':
    corr_rhf = [r[1] - f[1] for r, f in zip(rhf_result, fci_result)]
    # corr_ccsd = [c - f for c, f in zip(ccsd_result, fci_result)]
    corr_fmo_rhf = [r[1] - f[1] for r, f in zip(fmo_rhf_result, fci_result)]
    corr_fmo_vqe = [v[1] - f[1] for v, f in zip(fmo_vqe_result, fci_result)]
    idx = [float(v[0]) for v in fmo_vqe_result]
    idx_vqe_conv = [float(v[0]) for v in fmo_vqe_result if v[2]]
    corr_fmo_vqe_conv = [float(v) for i, v in enumerate(corr_fmo_vqe) if fmo_vqe_result[i][2]]
    idx_vqe_not_conv = [float(v[0]) for v in fmo_vqe_result if not v[2]]
    corr_fmo_vqe_not_conv = [float(v) for i, v in enumerate(corr_fmo_vqe) if not fmo_vqe_result[i][2]]

    plt.xlabel("d2")
    plt.ylabel("Err btw FCI (Ha)")
    plt.plot(idx, corr_rhf, 'ko-', label="RHF")
    plt.plot(idx, corr_fmo_rhf, color="gray", marker='+', label="FMO_RHF")
    plt.plot(idx, corr_fmo_vqe, color="blue")
    plt.plot(idx_vqe_conv, corr_fmo_vqe_conv, color="blue", marker='+', label="FMO_VQE_Converged")
    plt.plot(idx_vqe_not_conv, corr_fmo_vqe_not_conv, 'r+', label="FMO_VQE_not_Converged")
    plt.axhline(y=0.01, color='red', label="C.A(10mHa)")
    plt.axhline(y=-0.01, color='red')
    # plt.plot(idx, corr_ccsd, color="silver", marker='o', label="CCSD")
    plt.legend()
    plt.show()
